CREATE TABLE usuario(
	id_usuario SERIAL NOT NULL,
	mail VARCHAR(30) NOT NULL,
	contrase√±a VARCHAR(30) NOT NULL,
	CONSTRAINT pk_id_usuario PRIMARY KEY (id_usuario)
);


CREATE TABLE cliente(
	id_cliente BIGINT NOT NULL,
	dni INTEGER NOT NULL,
	nombre VARCHAR(30) NOT NULL,
	apellido VARCHAR(30) NOT NULL,
	direccion VARCHAR(30) NOT NULL,
	telefono VARCHAR(30) NOT NULL,
	mail VARCHAR(30) NOT NULL,
	CONSTRAINT pk_id_cliente PRIMARY KEY (id_cliente)
);

ALTER TABLE cliente DROP COLUMN ciudad;


CREATE TABLE proveedor(
	id_proveedor SERIAL NOT NULL,
	dni INTEGER NOT NULL,
	nombre VARCHAR(30) NOT NULL,
	apellido VARCHAR(30) NOT NULL,
	direccion VARCHAR(30) NOT NULL,
	telefono VARCHAR(30) NOT NULL,
	mail VARCHAR(30) NOT NULL,
	descripcion VARCHAR(30) NOT NULL,
	CONSTRAINT pk_id_proveedor PRIMARY KEY (id_proveedor)
);

SELECT * FROM proveedor;


CREATE TABLE producto(
	id_producto SERIAL NOT NULL,
	modelo VARCHAR(30) NOT NULL,
	marca VARCHAR(30) NOT NULL,
	descripcion VARCHAR(30) NOT NULL,
	tipoProducto VARCHAR(30) NOT NULL,
	stock INTEGER NOT NULL,
	precio INTEGER NOT NULL,
	CONSTRAINT pk_id_producto PRIMARY KEY(id_producto)
);

CREATE TABLE venta(
	id_venta SERIAL NOT NULL,
	id_cliente INTEGER NOT NULL,
	fecha DATE NOT NULL,
	total INTEGER NOT NULL,
	CONSTRAINT pk_id_venta PRIMARY KEY(id_venta),
	CONSTRAINT fk_id_cliente FOREIGN KEY(id_cliente) REFERENCES cliente(id_cliente)
);

CREATE TABLE presupuesto(
	id_presupuesto SERIAL NOT NULL,
	arreglo INTEGER NOT NULL,
	observacion VARCHAR(100) NOT NULL,
	precioTotal INTEGER NOT NULL,
	CONSTRAINT pk_id_presupuesto PRIMARY KEY(id_presupuesto),
	CONSTRAINT fk_arreglo FOREIGN KEY(arreglo) REFERENCES arreglo(id_arreglo)
);

CREATE TABLE presupuestoProducto(
	id_presupuestoProducto SERIAL NOT NULL,
	presupuesto INTEGER NOT NULL,
	producto INTEGER NOT NULL,
	cantidad INTEGER NOT NULL,
	precio INTEGER NOT NULL,
	CONSTRAINT pk_id_presupuesto_producto PRIMARY KEY(id_presupuestoProducto),
	CONSTRAINT fk_id_presupuesto FOREIGN KEY(presupuesto) REFERENCES presupuesto(id_presupuesto),
	CONSTRAINT fk_id_producto_presupuesto FOREIGN KEY(producto) REFERENCES producto(id_producto)
);

CREATE TABLE ventaProducto(
	id_ventaProducto SERIAL NOT NULL,
	id_venta INTEGER NOT NULL,
	id_producto INTEGER NOT NULL,
	cantidad INTEGER NOT NULL,
	precio INTEGER NOT NULL,
	CONSTRAINT pk_idProducto PRIMARY KEY(id_ventaProducto),
	CONSTRAINT fk_id_venta FOREIGN KEY(id_venta) REFERENCES venta(id_venta),
	CONSTRAINT fk_id_producto FOREIGN KEY(id_producto) REFERENCES producto(id_producto)
);

CREATE TABLE arreglo(
	id_arreglo SERIAL NOT NULL,
	cliente INTEGER NOT NULL,
	producto INTEGER NOT NULL,
	fecha DATE NOT NULL,
	observacion VARCHAR(100) NOT NULL,
	condicion VARCHAR (100) NOT NULL,
	CONSTRAINT pk_idArreglo PRIMARY KEY(id_arreglo),
	CONSTRAINT fk_id_clienteA FOREIGN KEY(cliente) REFERENCES cliente(id_cliente),
	CONSTRAINT fk_id_productoA FOREIGN KEY(producto) REFERENCES producto(id_producto)
);

SELECT * FROM ventaProducto;
DELETE FROM venta
INSERT INTO venta VALUES(1,2,3,'20/12/2018');

INSERT INTO cliente VALUES(3,39261832,'Sebastian','Bonato','Herrera','CLSN','3442507780','sebabonato12@gmail.com');

INSERT INTO producto VALUES(1,'Iphone X','Celular',50000);
INSERT INTO producto VALUES(2,'Samsung J7','Celular',50000);
INSERT INTO producto VALUES(3,'Samsung S6','Celular',50000);

INSERT INTO  venta VALUES(1,120,3,'24/01/2009');

DROP CASCADE FROM venta WHERE id_venta = 177;

SELECT * FROM venta

SELECT * FROM cliente WHERE id_cliente = 178

SELECT * FROM arreglo;


SELECT * FROM presupuesto;
SELECT p.id_presupuesto FROM presupuesto p  WHERE p.arreglo = (3)

SELECT p.id_presupuesto FROM presupuesto p  WHERE p.arreglo=3 

SELECT  PP.id_presupuestoProducto, PP.presupuesto, PP.producto, PP.cantidad, PP.precio  FROM presupuesto P, presupuestoProducto PP WHERE PP.presupuesto = P.id_presupuesto AND PP.presupuesto =1
